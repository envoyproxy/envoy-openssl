--- boringssl/include/openssl/base.h	2023-04-03 10:20:44.420079267 +0100
+++ include/openssl/base.h	2023-04-06 12:55:08.433620362 +0100
@@ -79,6 +79,9 @@
 #include <boringssl_prefix_symbols.h>
 #endif
 
+#include <ossl/openssl/ossl_typ.h>
+#include <ossl/openssl/ssl.h>
+
 #if defined(__cplusplus)
 extern "C" {
 #endif
@@ -120,6 +123,8 @@
 #define OPENSSL_32_BIT
 #elif defined(__riscv) && __riscv_xlen == 64
 #define OPENSSL_64_BIT
+#elif defined(__s390x__)
+#define OPENSSL_64_BIT
 #else
 // Note BoringSSL only supports standard 32-bit and 64-bit two's-complement,
 // little-endian architectures. Functions will not produce the correct answer
@@ -185,6 +190,7 @@
 #define OPENSSL_THREADS
 #endif
 
+#define BSSL_COMPAT
 #define OPENSSL_IS_BORINGSSL
 #define OPENSSL_VERSION_NUMBER 0x1010107f
 #define SSLEAY_VERSION_NUMBER OPENSSL_VERSION_NUMBER
@@ -343,13 +349,13 @@
 typedef struct asn1_string_st ASN1_ENUMERATED;
 typedef struct asn1_string_st ASN1_GENERALIZEDTIME;
 typedef struct asn1_string_st ASN1_GENERALSTRING;
-typedef struct asn1_string_st ASN1_IA5STRING;
-typedef struct asn1_string_st ASN1_INTEGER;
+typedef ossl_ASN1_IA5STRING  ASN1_IA5STRING;
+typedef ossl_ASN1_INTEGER    ASN1_INTEGER;
 typedef struct asn1_string_st ASN1_OCTET_STRING;
 typedef struct asn1_string_st ASN1_PRINTABLESTRING;
-typedef struct asn1_string_st ASN1_STRING;
+typedef ossl_ASN1_STRING     ASN1_STRING;
 typedef struct asn1_string_st ASN1_T61STRING;
-typedef struct asn1_string_st ASN1_TIME;
+typedef ossl_ASN1_TIME       ASN1_TIME;
 typedef struct asn1_string_st ASN1_UNIVERSALSTRING;
 typedef struct asn1_string_st ASN1_UTCTIME;
 typedef struct asn1_string_st ASN1_UTF8STRING;
@@ -375,9 +381,9 @@
 typedef struct X509_req_st X509_REQ;
 typedef struct X509_sig_st X509_SIG;
 typedef struct bignum_ctx BN_CTX;
-typedef struct bignum_st BIGNUM;
+typedef ossl_BIGNUM BIGNUM;
 typedef struct bio_method_st BIO_METHOD;
-typedef struct bio_st BIO;
+typedef ossl_BIO BIO;
 typedef struct blake2b_state_st BLAKE2B_CTX;
 typedef struct bn_gencb_st BN_GENCB;
 typedef struct bn_mont_ctx_st BN_MONT_CTX;
@@ -392,17 +398,17 @@
 typedef struct dh_st DH;
 typedef struct dsa_st DSA;
 typedef struct ec_group_st EC_GROUP;
-typedef struct ec_key_st EC_KEY;
+typedef ossl_EC_KEY EC_KEY;
 typedef struct ec_point_st EC_POINT;
 typedef struct ecdsa_method_st ECDSA_METHOD;
 typedef struct ecdsa_sig_st ECDSA_SIG;
-typedef struct engine_st ENGINE;
-typedef struct env_md_ctx_st EVP_MD_CTX;
-typedef struct env_md_st EVP_MD;
+typedef ossl_ENGINE ENGINE;
+typedef ossl_EVP_MD_CTX EVP_MD_CTX;
+typedef ossl_EVP_MD EVP_MD;
 typedef struct evp_aead_st EVP_AEAD;
 typedef struct evp_aead_ctx_st EVP_AEAD_CTX;
-typedef struct evp_cipher_ctx_st EVP_CIPHER_CTX;
-typedef struct evp_cipher_st EVP_CIPHER;
+typedef ossl_EVP_CIPHER_CTX EVP_CIPHER_CTX;
+typedef ossl_EVP_CIPHER EVP_CIPHER;
 typedef struct evp_encode_ctx_st EVP_ENCODE_CTX;
 typedef struct evp_hpke_aead_st EVP_HPKE_AEAD;
 typedef struct evp_hpke_ctx_st EVP_HPKE_CTX;
@@ -410,9 +416,9 @@
 typedef struct evp_hpke_kem_st EVP_HPKE_KEM;
 typedef struct evp_hpke_key_st EVP_HPKE_KEY;
 typedef struct evp_pkey_asn1_method_st EVP_PKEY_ASN1_METHOD;
-typedef struct evp_pkey_ctx_st EVP_PKEY_CTX;
+typedef ossl_EVP_PKEY_CTX EVP_PKEY_CTX;
 typedef struct evp_pkey_method_st EVP_PKEY_METHOD;
-typedef struct evp_pkey_st EVP_PKEY;
+typedef ossl_EVP_PKEY EVP_PKEY;
 typedef struct hmac_ctx_st HMAC_CTX;
 typedef struct md4_state_st MD4_CTX;
 typedef struct md5_state_st MD5_CTX;
@@ -424,21 +430,21 @@
 typedef struct rc4_key_st RC4_KEY;
 typedef struct rsa_meth_st RSA_METHOD;
 typedef struct rsa_pss_params_st RSA_PSS_PARAMS;
-typedef struct rsa_st RSA;
+typedef ossl_RSA RSA;
 typedef struct sha256_state_st SHA256_CTX;
 typedef struct sha512_state_st SHA512_CTX;
 typedef struct sha_state_st SHA_CTX;
 typedef struct spake2_ctx_st SPAKE2_CTX;
 typedef struct srtp_protection_profile_st SRTP_PROTECTION_PROFILE;
-typedef struct ssl_cipher_st SSL_CIPHER;
-typedef struct ssl_ctx_st SSL_CTX;
+typedef ossl_SSL_CIPHER SSL_CIPHER;
+typedef ossl_SSL_CTX SSL_CTX;
 typedef struct ssl_early_callback_ctx SSL_CLIENT_HELLO;
 typedef struct ssl_ech_keys_st SSL_ECH_KEYS;
-typedef struct ssl_method_st SSL_METHOD;
+typedef ossl_SSL_METHOD SSL_METHOD;
 typedef struct ssl_private_key_method_st SSL_PRIVATE_KEY_METHOD;
 typedef struct ssl_quic_method_st SSL_QUIC_METHOD;
-typedef struct ssl_session_st SSL_SESSION;
-typedef struct ssl_st SSL;
+typedef ossl_SSL_SESSION SSL_SESSION;
+typedef ossl_SSL SSL;
 typedef struct ssl_ticket_aead_method_st SSL_TICKET_AEAD_METHOD;
 typedef struct st_ERR_FNS ERR_FNS;
 typedef struct trust_token_st TRUST_TOKEN;
@@ -451,7 +457,7 @@
 typedef struct x509_lookup_method_st X509_LOOKUP_METHOD;
 typedef struct x509_object_st X509_OBJECT;
 typedef struct x509_revoked_st X509_REVOKED;
-typedef struct x509_st X509;
+typedef ossl_X509 X509;
 typedef struct x509_store_ctx_st X509_STORE_CTX;
 typedef struct x509_store_st X509_STORE;
 typedef struct x509_trust_st X509_TRUST;
